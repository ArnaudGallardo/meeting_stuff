<template name="home">
  <!-- Modal -->
  <div class="modal fade" id="roomModal" tabindex="-1" role="dialog" aria-labelledby="addRoom">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <form id="createRoom" action="#" >
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">Create a new room</h4>
          </div>
          <div class="modal-body">
            <div class="input-group">
              <span class="input-group-addon" id="subjLabel">Subject</span>
              <input type="text" class="form-control" id="meetingSubj" aria-describedby="subjLabel">
            </div>
            <div class="input-group">
              <span class="input-group-addon" id="langLabel">Language</span>
              <select class="selectpicker" id="meetingLang" aria-describedby="langLabel">
                <option value="en-US">English (US)</option>
                <option value="en-EN">English (GB)</option>
                <option value="fr-FR">French</option>
                <option value="es-ES">Spanish</option>
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <input type="submit" class="btn btn-primary" value="Create room"/>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="modal fade" id="friendModal" tabindex="-1" role="dialog" aria-labelledby="addFriend">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <form id="addFriend" action="#" >
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">Add a new friend</h4>
          </div>
          <div class="modal-body">
            {{#if isSelectedFriend}}
              <p style="font-size:18px">
                Do you really want to invite <span style="color:#0ce3ac">{{getFriendName}}</span> to join your friendlist ?
              </p>
            {{else}}
              {{> friendType}}
            {{/if}}
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal" id="cancelFriend">Close</button>
            <input type="submit" class="btn btn-primary" value="Add friend"/>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="container" style="padding-top:40px;height:100%">
    <div class="row">
      <div class="col-xs-2">
        <h1 style="color:#EEE">Transcripter</h1>
      </div>
    </div>
    <div class="row">
      <div class="container meetingsList col-xs-8" style="padding:0;overflow:hidden;">
        <div class="meet">
          <button type="button" class="btn btn-success" data-toggle="modal" data-target="#roomModal"
          style="display: block;width: 100%;border: none;margin: 0;padding: 0;height: 40px;border-radius: 0; outline:none">
            CREATE A NEW MEETING
          </button>
        </div>
        {{#if length getMeetings}}
          {{#each getMeetings}}
            <div class="meet">
              <span class="title">{{subject}}</span>
              <span class="date">{{getDate dateCreated}}</span>
              {{#if isStopped recordingState}}
                <!-- Split button -->
                <div class="btn-group pull-right" style="margin-top:7.5px;margin-right:20px">
                  <button type="button" class="btn btn-success btn-xs" id="downloadTxt" data-id="{{_id}}">Download txt</button>
                  <button type="button" class="btn btn-success btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="caret"></span>
                    <span class="sr-only">Toggle Dropdown</span>
                  </button>
                  <ul class="dropdown-menu">
                    <li><a id="downloadPdf" data-id="{{_id}}"><i class="fa fa-file-pdf-o"> PDF</i></a></li>
                  </ul>
                </div>
                <a href="/room/{{_id}}" class="link">View</a>
              {{else}}
                <a href="/room/{{_id}}" class="link">Join <i class="fa fa-caret-square-o-right faa-flash animated"></i></a>
              {{/if}}
            </div>
          {{/each}}
        {{else}}
        <div class="meet">
          <span class="title">You don't have any meetings... :'(</span>
        </div>
        {{/if}}
      </div>
      <div class="container meetingsList col-xs-offset-1 col-xs-3" style="padding:0;overflow:hidden;">
        <div class="meet">
          <button type="button" class="btn btn-success" id="add_friend" data-toggle="modal" data-target="#friendModal"
          style="display: block;width: 100%;border: none;margin: 0;padding: 0;height: 40px;border-radius: 0; outline:none">
          <i class="fa fa-user-plus"></i>
          </button>
        </div>
        <div class="meet">
          <p>
            Test
          </p>
        </div>
        {{#each getRequestsList}}
        <div class="meet">
          <div style="margin-left:10px;">
            {{> avatar userId=requesterId shape="circle" class="avatar-typeahead" size="small"}}
          </div>
          <span class="title">{{username}}</span>
          <button type="button" class="btn btn-danger btn-xs pull-right" style="margin-top:7.5px;margin-right:10px"
            id="denyRequest" data-id="{{_id}}"><i class="fa fa-user-times" data-id="{{_id}}"></i></button>
          <button type="button" class="btn btn-success btn-xs pull-right" style="margin-top:7.5px;margin-right:10px"
            id="acceptRequest" data-id="{{_id}}"><i class="fa fa-user-plus" data-id="{{_id}}"></i></button>
        </div>
        {{/each}}
        <div class="meetSep"></div>
        {{#each getFriendsList}}
        <div class="meet">
          <div style="margin-left:10px;">
            {{> avatar userId=friendId shape="circle" class="avatar-typeahead" size="small"}}
          </div>
          <span class="title">{{username}}</span>
        </div>
        {{/each}}
      </div>
    </div>
    <div class="row">
      <div class="col-xs-3">
        {{> loginButtons}}
      </div>
    </div>
  </div>

  <script>
    $('.selectpicker').selectpicker({
      width: 'auto'
    });
    $("body").backstretch("/conference2.jpg");
  </script>
</template>
<template name="userlist">
  <div>
    {{> avatar userId=_id shape="circle" class="avatar-typeahead" size="small"}}
    <span style="height:40px;line-height:40px">{{value}}</span>
  </div>
</template>
<template name="friendType">
  <div>
    <input class="form-control typeahead" name="friendUsername" type="text"
     placeholder="All users"
     autocomplete="off" spellcheck="off"
     data-source="getUserlist"
     data-template="userlist"/>
  </div>
</template>
